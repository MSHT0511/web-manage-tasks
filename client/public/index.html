<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>タスク管理ツール</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    function App() {
      const [tasks, setTasks] = useState([]);
      const [input, setInput] = useState('');

      useEffect(() => {
        fetch('/api/tasks')
          .then(res => res.json())
          .then(setTasks)
          .catch(err => console.error('タスク取得エラー:', err));
      }, []);

      const addTask = async () => {
        if (!input.trim()) return;
        try {
          const res = await fetch('/api/tasks', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ title: input })
          });
          const newTask = await res.json();
          setTasks([...tasks, newTask]);
          setInput('');
        } catch (err) {
          console.error('タスク追加エラー:', err);
        }
      };

      const deleteTask = async (id) => {
        try {
          await fetch(`/api/tasks/${id}`, { method: 'DELETE' });
          setTasks(tasks.filter(t => t.id !== id));
        } catch (err) {
          console.error('タスク削除エラー:', err);
        }
      };

      const handleKeyPress = (e) => {
        if (e.key === 'Enter') {
          addTask();
        }
      };

      return (
        <div style={{ maxWidth: 500, margin: '40px auto', fontFamily: 'sans-serif', padding: '0 20px' }}>
          <h1>タスク管理ツール</h1>
          <div style={{ display: 'flex', marginBottom: 16, gap: 8 }}>
            <input
              value={input}
              onChange={e => setInput(e.target.value)}
              onKeyPress={handleKeyPress}
              placeholder="新しいタスクを入力"
              style={{ flex: 1, padding: '10px 12px', fontSize: '14px', border: '1px solid #ddd', borderRadius: 4 }}
            />
            <button
              onClick={addTask}
              style={{ padding: '10px 20px', fontSize: '14px', backgroundColor: '#007bff', color: 'white', border: 'none', borderRadius: 4, cursor: 'pointer' }}
            >
              追加
            </button>
          </div>
          <ul style={{ listStyle: 'none', padding: 0 }}>
            {tasks.map(task => (
              <li
                key={task.id}
                style={{
                  display: 'flex',
                  alignItems: 'center',
                  marginBottom: 8,
                  padding: '12px',
                  backgroundColor: '#f8f9fa',
                  borderRadius: 4,
                  border: '1px solid #e9ecef'
                }}
              >
                <span style={{ flex: 1, fontSize: '14px' }}>{task.title}</span>
                <button
                  onClick={() => deleteTask(task.id)}
                  style={{ marginLeft: 8, padding: '6px 12px', fontSize: '12px', backgroundColor: '#dc3545', color: 'white', border: 'none', borderRadius: 4, cursor: 'pointer' }}
                >
                  削除
                </button>
              </li>
            ))}
          </ul>
          {tasks.length === 0 && (
            <div style={{ textAlign: 'center', color: '#999', padding: '20px', fontSize: '14px' }}>
              タスクがありません。上記から追加してください。
            </div>
          )}
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
